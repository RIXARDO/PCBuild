@model PCbuild_ASP.MVC_.Models.Build

@{
    ViewBag.Title = "Index";
}


<h2>Index</h2>


@{ 
}
<script type="text/javascript"></script>
<script>
    //document.addEventListener("DOMContentLoaded", function () {
    //    var cpu = new { value="Intel" };
    //    var gpu = new {value="Nvidia"};
    //
    //    onchangeCPU(cpu);
    //    onchangeGPU(gpu);
    //});


    function onchangeCPU(elem) {
        var cpus = document.getElementById('CPUs'); @*$('#CPUs');*@
        while (cpus.firstChild) {

            cpus.removeChild(cpus.firstChild);
        }

        $.ajax({
            url: "/Build/DropDownListCPU",
            method: "GET",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            data: 'value='+elem.value,
            success: function (result) {
                for (var i=0; i < result.length; i++) {
                    cpus.add(new Option(result[i].text, result[i].value));
                }  
            }
        });
    }

    function onchangeGPU(elem) {
        var gpus = document.getElementById('GPUs'); @* $('#GPUs');*@

        while (gpus.firstChild){

            gpus.removeChild(gpus.firstChild);
        }

        $.ajax({
            url: "/Build/DropDownListGPU",
            method: "GET",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            data: 'value=' +elem.value,
            success: function (result) {
                //alert("result: " + result.length + " gpus:" + gpus.options.length);
                for (var i = 0; i < result.length; i++) {
                    gpus.add(new Option(result[i].text, result[i].value));
                }
            }
        });
    }
</script>

@using (Ajax.BeginForm("Action", "Build", new AjaxOptions { UpdateTargetId = "results", HttpMethod="Post" }))
{
    
    <table class="table">
        <tr>
            <td>CPU</td>
            <td>GPU</td>
            <td>Screen</td>
        </tr>

        <tr>
            <td>
                @Html.RadioButton("CPU", "Intel", true, new { @OnChange = "onchangeCPU(this)" })
                <span>Intel</span>
            </td>
            <td>
                @Html.RadioButton("GPU", "Nvidia", true, new { @OnChange = "onchangeGPU(this)" })
                <span>Nvidia</span>
            </td>
            <td>
                @Html.RadioButton("ScreenRez", "p1080", true)
                <span>1080p</span>
            </td>
        </tr>
        <tr>
            <td>
                @Html.RadioButton("CPU", "AMD", new { @OnChange = "onchangeCPU(this)" })
                <span>AMD</span>
            </td>
            <td>
                @Html.RadioButton("GPU", "Radeon", new { @OnChange = "onchangeGPU(this)" })
                <span>Radeon</span>
            </td>
            <td>
                @Html.RadioButton("ScreenRez", "p1440")
                <span>1440p</span>
            </td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td>
                @Html.RadioButton("ScreenRez", "p2560")
                <span>2560p</span>
            </td>
        </tr>
            <tr>
                <td>
                    @*<select id="CPUs" ></select>*@
                    @Html.DropDownListFor(x => x.CPUs, new SelectList(Model.CPUs.Where(x => x.Manufacture == "Intel").
                AsEnumerable(), "CPUID", "ProcessorNumber"))
                </td>
                <td>
                    @*<select id="GPUs"></select>*@
                    @Html.DropDownListFor(x => x.GPUs, new SelectList(Model.GPUs.Where(x => x.Manufacture == "Nvidia").
        AsEnumerable(), "GPUID", "Name"))
                </td>
            </tr>
    </table>

    <input type="submit" value="Action" />
}
<div id="results"></div>
@Scripts.Render("~/scripts/jquery-3.3.1.min.js")
@Scripts.Render("~/scripts/jquery.unobtrusive-ajax.min.js")